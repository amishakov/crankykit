<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
	<meta charset="utf-8"/>
</head>
<body>

<h1 id="crankykit:ariffonkirbyplainkit">Crankykit: A riff on Kirby Plainkit</h1>

<h2 id="overview">Overview</h2>

<p>This is an opinionated version of <a href="https://GitHub.com/getkirby/plainkit.git">Kirby Plainkit</a> meant to be used on shared hosting plans that allow the user to load files <em>outside</em> the public web root directory. It&#8217;s configured to work on <a href="https://siteground.com">Siteground</a> hosting out of the box, but can be easily adapted to other hosts. There are no symlinks; the only files in the public web root directory are those that Kirby requires to be there. Everything else is safely outside the web server&#8217;s grasp.</p>

<p>I made this because I was a bit unclear on how to make this work and I&#8217;ve seen questions from newbies like me on the excellent <a href="https://forum.getkirby.com">support forum</a> from time to time and I thought it&#8217;d be nice to have a nice starting point for my own new Kirby projects.</p>

<p>The core Kirby system files are referenced as a git submodule (which means they aren&#8217;t physically included in this repo). I started on this when Kirby was at version 3.6.5, but I didn&#8217;t want to always be updating this to keep the system current. See the <a href="#installation"><code>Installation</code></a> details below.</p>

<p>This was made for my personal use and there are no guarantees it will work for you. Its quirks are mine, you&#8217;re welcome to your own. I&#8217;m making this freely available. I hope you find it useful. I&#8217;ll answer questions that I can, but this is very definitely an &#8220;as-is&#8221; thing.</p>

<h2 id="anamesubmodulesinstallationa"><a name="submodules">Installation</a></h2>

<ol>
<li><p>The Kirby system files are referenced as a Git submodule because it lets me treat those files as a black box. There&#8217;s a very practical implication to this strategy: I&#8217;m not including Kirby files. I&#8217;m including a way for you to use the version you want to use.</p>

<ul>
<li>If you just clone this repository you will <strong>not</strong> automatically download Kirby (the directory will be there, but it will be empty). Navigate into the Kirby directory and issue the command</li>
</ul>

<p><code>git submodule init</code>,</p>

<p>then</p>

<p><code>git submodule update</code>.</p>

<p>Any time you need to update the system files, just run the second command (<code>git submodule update</code>) again. The Kirby documentation encourages you to delete <code>/public_html/media</code> any time the Kirby version changes. It will be regenerated as needed.</p></li>
</ol>

<h2 id="details">Details</h2>

<ol>
<li><p>This is adapted from the <a href="https://getkirby.com/docs/guide/configuration#custom-folder-setup__public-folder-setup">Public Folder Setup</a> example in the Kirby Guide.</p></li>
<li><p>The public web root directory is called <code>/public_html</code> on Siteground. You may need to change this.</p></li>
<li><p><p>Two configuration files are included in `/site/config'.</p>

<ul>
<li><code>config.php</code> allows the panel to be installed on a remote server and changes the page slug for the panel from <code>myexample.com/panel' to</code>myexample.com/knockknock`. Seek professional help is that&#8217;s the slug you want to use.</li>
<li><code>config.crankykit.test.php</code> turns on debugging only on a host that answers to the name <code>crankykit.test</code>. Make it your own by changing the name to that works on your development setup.</li>
</ul></p></li>
<li><p>The <code>.htaccess</code> file is located in the public web root. It&#8217;s the &#8220;stock&#8221; Kirby <code>.htaccess</code> file with the addition of the directive</p>

<p><code>Header set Cache-Control &quot;no cache, private&quot;</code></p>

<p>to minimize the impact of Siteground&#8217;s dynamic caching on Kirby license validation. See <a href="https://forum.getkirby.com/t/kirby-3-panel-not-updating-server-caching-or-license-key-issue/21444">this discussion</a> for the gory details about why this is here.</p></li>
<li><p><code>index.html</code> is also located in <code>public_html</code> and is pictured below. Out of the box, Kirby assumes a flat directory structure.</p>

<img width="688" alt="screenshot of index.php" src="https://user-images.githubusercontent.com/284185/165156578-c05be891-641d-44b5-92ba-22588e260044.png">

<ul>
<li><p>Line 7 takes care of determining the name of the public web root. It doesn&#8217;t need to be specified anywhere.</p></li>
<li><p><p>Line 8 is written to determine the <em>parent</em> of the public web root directory.
The location of the non-public files are not required to be in the parent of the web root.
The only thing that&#8217;s required is that the directory of the non-public files are reachable via a relative path
from the public web root.</p></p></li>
</ul></li>
<li><p>The `/media' directory will be created in the public web root. It can be deleted at any time and it will be regenerated as needed.</p></li>
<li><p><p>A <code>/storage</code> directory has been added as a sibling to <code>/content</code> and <code>/ site</code> to contain <code>/accounts</code>, <code>/cache</code>, and <code>/sessions</code>.
These subdirectories should be writable by the web server.</p></p></li>
<li><p>An <code>/assets</code> directory has been added to the public web root to hold CSS, JS, fonts, and graphics. A basic CSS scaffold is included.</p></li>
</ol>

</body>
</html>

